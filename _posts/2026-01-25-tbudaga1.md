---
layout: post
title:  "HW1"
author: Tavishi
jhed: tbudaga1
categories: [ HW1 ]
image: homework/hw1/hw1_tbudaga1.png
featured: false
---

### 1. What about the data are you trying to make salient through this data visualization? 
The goal of this visualization was to make salient the spatial location of the highest and lowest expressed genes. This visualization allows the viewer to see the areas where the highest expressed gene, Cyp4b1, and the lowest expressed gene, Epo, are in the kidney. I was curious to see if these genes overlapped in regions or if they were expressed in different regions. The data visualization revealed that there was little overlap between the two genes that I was looking at. 

### 2. What are the data types represented?
The data types represented in this visualization are quantitative data, spatial coordinates/positional data, and categorical data. The gene expression values are numerical counts and the x and y coordinates show where each expression measurement is in the tissue (location of the gene). The type of gene (highest expressing and lowest expressing) is catergorical.

### 3. What data encodings (geometric primitives and visual channels) are you choosing to visualize these data types?
The geometric primitives used were points to represent each spot in the tissue. Color, more specifically hue, was used to depict the different genes and where the gene was expressed. This allows one to quickly discern the highest expressed gene from the lowest expressed gene. Additionally, size was used to also differentiate between the highest expressed gene and the lowest expressed gene. The highest expressed gene had a larger dot and the lowest expressed gene had a smaller dot. 

### 4. What Gestalt principles or knowledge about perceptiveness of visual encodings are you using to accomplish this?
This visualization used the Gestalt principles of similarity and proximity. Similarity is seen through the different hues used. Spots of the same color express the same gene making it easy to identify the most expressed gene and the least expressed gene. This allows one to automatically group the genes together. Proximity was also used as points that are close together from clusters which helps show the different regions of gene activity. 


### 5. Code 
```r
library(ggplot2)

# reading the data
data <- read.csv('C:/Users/gtbud/Downloads/Xenium-IRI-ShamR_matrix.csv.gz')

# getting only the gene expression columns 
gexp <- data[, 4:ncol(data)]

# calculate total expression for each gene
total_expression <- colSums(gexp)

# find the highest and lowest gene expressed
highest_gene <- names(which.max(total_expression))
lowest_gene  <- names(which.min(total_expression))

# print genes
print(highest_gene)
print(lowest_gene)

# data frame for plotting
df_long <- data.frame(
  x = rep(data$x, 2),
  y = rep(data$y, 2),
  gene = rep(c(highest_gene, lowest_gene), each = nrow(data))
)

# change dot size so dots don't get overlapped 
df_long$dot_size <- ifelse(df_long$gene == highest_gene, 4, 0.5)

# plotting
ggplot(df_long, aes(x = x, y = y, color = gene)) +
  geom_point(aes(size = dot_size), alpha = 0.6) +  # <-- important +
  scale_color_manual(values = c(
    "Cyp4b1" = "darkred",  
    "Epo"  = "lightblue" 
  )) +
  scale_size_identity() + 
  coord_fixed() +
  theme_minimal(base_size = 14) +
  labs(
    title = "Spatial Location of Cyp4b1 (highest expression) 
    and Epo (lowest expression)",
    x = "X Coordinate",
    y = "Y Coordinate",
    color = "Gene"
  )

# AI was used to learn how to change the dot sizes so they do not overlap, learn how to find the highest and lowest gene expressed, and how to create the data frame for plotting
